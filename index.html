
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FalakZoom</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
      body {
        margin: 0;
        overflow: hidden;
        background: black;
        font-family: Arial, sans-serif;
      }

      /* Updated infoPanel position */
      #infoPanel {
        position: absolute;
        top: 70px;
        left: 20px;
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 15px;
        border-radius: 8px;
        border: 2px solid rgba(255, 255, 255, 0.5);
        display: none;
        max-width: 350px;
        font-size: 14px;
        font-family: 'Poppins', sans-serif;
        line-height: 1.6;
        text-align: right;
        z-index: 50;
      }

      #closeBtn {
        position: absolute;
        top: 10px;
        left: 10px;
        width: 30px;
        height: 30px;
        font-size: 18px;
        font-weight: bold;
        color: #ff4444;
        cursor: pointer;
        transition: transform 0.3s ease, color 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
        padding: 0;
        background: transparent;
        border: none;
        border-radius: 5px;
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.3);
      }

      #closeBtn:hover {
        color: #ff6666;
        transform: scale(1.15);
        background: rgba(255, 255, 255, 0.2);
        box-shadow: 0px 8px 16px rgba(0, 0, 0, 0.5);
      }

      /* Menu Bar Styles */
      #menuBar {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 50px;
        background: rgba(0, 0, 0, 0.7);
        padding: 10px 20px;
        box-sizing: border-box;
        display: flex;
        justify-content: space-between;
        align-items: center;
        z-index: 100;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      }

      .menu-item {
        position: relative;
        color: white;
        padding: 8px 15px;
        margin-left: auto;
        margin-right: 20px;
        cursor: pointer;
        font-family: 'Poppins', sans-serif;
        border-radius: 4px;
        transition: background 0.3s ease;
      }

      .menu-item:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .dropdown {
        position: absolute;
        top: 100%;
        right: 0;
        background: rgba(0, 0, 0, 0.9);
        min-width: 200px;
        border-radius: 0 0 4px 4px;
        overflow: hidden;
        display: none;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
      }

      .dropdown.show {
        display: block;
      }

      .dropdown-item {
        padding: 10px 15px;
        color: white;
        text-decoration: none;
        display: block;
        transition: background 0.2s ease;
      }

      .dropdown-item:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      #title {
        color: white;
        font-family: 'Poppins', sans-serif;
        font-size: 24px;
        font-weight: 600;
      }
    </style>
  </head>
  <body>
    <div id="menuBar">
      <div id="title">FalakZoom</div>
      <div class="menu-item" id="planetsMenu">
        الكواكب
        <div class="dropdown" id="planetsDropdown">
          <a href="#" class="dropdown-item" data-planet="0">الشمس</a>
          <a href="#" class="dropdown-item" data-planet="1">عطارد</a>
          <a href="#" class="dropdown-item" data-planet="2">الزهرة</a>
          <a href="#" class="dropdown-item" data-planet="3">الأرض</a>
          <a href="#" class="dropdown-item" data-planet="4">المريخ</a>
          <a href="#" class="dropdown-item" data-planet="5">المشتري</a>
          <a href="#" class="dropdown-item" data-planet="6">زحل</a>
          <a href="#" class="dropdown-item" data-planet="7">أورانوس</a>
          <a href="#" class="dropdown-item" data-planet="8">نبتون</a>
        </div>
      </div>
    </div>
    <div id="infoPanel">
      <span id="closeBtn">X</span>
      <h2 id="planetName"></h2>
      <p id="planetInfo"></p>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three/examples/js/controls/OrbitControls.js"></script>
    <script>
      // Scene Setup
      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 2000);
      camera.position.set(0, 50, 100);
      const renderer = new THREE.WebGLRenderer({
        antialias: true
      });
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);
      
      // Controls
      const controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.maxDistance = 300;
      controls.enableDamping = true;
      controls.dampingFactor = 0.05;
      
      // Following variables
      let focusedPlanetIndex = -1;
      let isFollowingPlanet = false;
      
      controls.addEventListener('start', () => {
        isFollowingPlanet = false;
        focusedPlanetIndex = -1;
      });
      
      // Advanced Lighting
      const sunLight = new THREE.PointLight(0xffffff, 1.5, 1000);
      sunLight.position.set(0, 0, 0);
      scene.add(sunLight);
      const ambientLight = new THREE.AmbientLight(0x404040, 0.5);
      scene.add(ambientLight);
      const hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444, 0.3);
      hemiLight.position.set(0, 100, 0);
      scene.add(hemiLight);
      
      // Texture Loader
      const loader = new THREE.TextureLoader();
      
      // Starry Background
      const starGeometry = new THREE.BufferGeometry();
      const starCount = 5000;
      const positions = new Float32Array(starCount * 3);
      for (let i = 0; i < starCount; i++) {
        positions[i * 3] = (Math.random() - 0.5) * 2000;
        positions[i * 3 + 1] = (Math.random() - 0.5) * 2000;
        positions[i * 3 + 2] = (Math.random() - 0.5) * 2000;
      }
      starGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
      const starMaterial = new THREE.PointsMaterial({
        color: 0xffffff,
        size: 0.1
      });
      const stars = new THREE.Points(starGeometry, starMaterial);
      scene.add(stars);
      
      // Planets Data with Detailed Information
      const planets = [{
        name: "الشمس",
        radius: 5,
        distance: 0,
        speed: 0,
        tilt: 0,
        rotation: 0.01,
        texture: "sun.jpg",
        info: "القطر: 1.391 مليون كيلومتر\nالكتلة: 1.989 × 10³⁰ كيلوغرام\nالعمر: 4.6 مليار سنة\nالنوع: نجم من النوع G في التسلسل الرئيسي\nدرجة حرارة النواة: 15 مليون درجة مئوية\nيحتوي على 99.86% من كتلة النظام الشمسي"
      }, {
        name: "عطارد",
        radius: 0.5,
        distance: 10,
        speed: 0.0125,
        tilt: 0.034,
        rotation: 0.003,
        texture: "mercury.jpg",
        info: "القطر: 4,879 كيلومتر\nالكتلة: 3.3 × 10²³ كيلوغرام\nالمدار: 88 يومًا\nدرجة حرارة السطح: من -173°C إلى 427°C\nلا يحتوي على غلاف جوي\nأصغر كواكب المجموعة الشمسية، كوكب صخري مليء بالفوهات"
      }, {
        name: "الزهرة",
        radius: 0.8,
        distance: 15,
        speed: 0.004375,
        tilt: 177.4,
        rotation: 0.0004,
        texture: "venus.jpg",
        info: "القطر: 12,104 كيلومتر\nالكتلة: 4.87 × 10²⁴ كيلوغرام\nالمدار: 225 يومًا\nدرجة حرارة السطح: 464°C\nغلاف جوي كثيف من ثاني أكسيد الكربون\nأسخن كواكب المجموعة الشمسية، يدور بعكس اتجاه الدوران المعتاد (حركة تراجعية)"
      }, {
        name: "الأرض",
        radius: 1,
        distance: 20,
        speed: 0.003125,
        tilt: 23.5,
        rotation: 0.05,
        texture: "earth.jpg",
        info: "القطر: 12,742 كيلومتر\nالكتلة: 5.97 × 10²⁴ كيلوغرام\nالمدار: 365.25 يومًا\nدرجة حرارة السطح: من -88°C إلى 58°C\nمغطاة بنسبة 71% بالمياه\nالكوكب الوحيد المعروف بوجود الحياة، وله قمر واحد"
      }, {
        name: "المريخ",
        radius: 0.7,
        distance: 25,
        speed: 0.0025,
        tilt: 25.2,
        rotation: 0.048,
        texture: "mars.jpg",
        info: "القطر: 6,792 كيلومتر\nالكتلة: 6.42 × 10²³ كيلوغرام\nالمدار: 687 يومًا\nدرجة حرارة السطح: من -153°C إلى 20°C\nغلاف جوي رقيق من ثاني أكسيد الكربون\nيظهر باللون الأحمر بسبب أكسيد الحديد، وله قمران"
      }, {
        name: "المشتري",
        radius: 2.5,
        distance: 35,
        speed: 0.00125,
        tilt: 3.1,
        rotation: 0.1,
        texture: "jupiter.jpg",
        info: "القطر: 139,820 كيلومتر\nالكتلة: 1.898 × 10²⁷ كيلوغرام\nالمدار: 11.86 سنة\nدرجة حرارة السطح: -145°C\nعملاق غازي\nأكبر كواكب المجموعة الشمسية، يحتوي على البقعة الحمراء العظيمة، وله 79 قمرًا"
      }, {
        name: "زحل",
        radius: 2,
        distance: 45,
        speed: 0.0009375,
        tilt: 26.7,
        rotation: 0.09,
        texture: "saturn.jpg",
        info: "القطر: 116,460 كيلومتر\nالكتلة: 5.68 × 10²⁶ كيلوغرام\nالمدار: 29.46 سنة\nدرجة حرارة السطح: -184°C\nيتميز بحلقاته الشهيرة\nعملاق غازي، وله 83 قمرًا في مدارات مختلفة"
      }, {
        name: "أورانوس",
        radius: 1.5,
        distance: 55,
        speed: 0.0005,
        tilt: 97.8,
        rotation: 0.06,
        texture: "uranus.jpg",
        info: "القطر: 50,724 كيلومتر\nالكتلة: 8.68 × 10²⁵ كيلوغرام\nالمدار: 84 سنة\nدرجة حرارة السطح: -224°C\nعملاق جليدي\nيدور بشكل جانبي، يمتلك حلقات باهتة، وله 27 قمرًا"
      }, {
        name: "نبتون",
        radius: 1.5,
        distance: 65,
        speed: 0.000375,
        tilt: 28.3,
        rotation: 0.07,
        texture: "neptune.jpg",
        info: "القطر: 49,244 كيلومتر\nالكتلة: 1.02 × 10²⁶ كيلوغرام\nالمدار: 164.8 سنة\nدرجة حرارة السطح: -201°C\nعملاق جليدي\nيتميز بلونه الأزرق العميق، يمتلك أقوى الرياح في المجموعة الشمسية، وله 14 قمرًا"
      }];
      
      // Planet Meshes and Circular Orbits
      const planetMeshes = [];
      planets.forEach((planet) => {
        const geometry = new THREE.SphereGeometry(planet.radius, 128, 128);
        const material = new THREE.MeshStandardMaterial({
          color: 0xffffff,
          emissive: planet.name === "الشمس" ? 0xffff00 : 0x000000,
          emissiveIntensity: planet.name === "الشمس" ? 2 : 0
        });
        loader.load(`textures/${planet.texture}`,
          (texture) => {
            material.map = texture;
            if (planet.name === "الشمس") {
              material.emissive = new THREE.Color(0xffff00);
              material.emissiveIntensity = 1.5;
            }
            material.needsUpdate = true;
          }, undefined,
          (err) => console.error(`Error loading texture: ${planet.texture}`, err));
        const mesh = new THREE.Mesh(geometry, material);
        mesh.position.x = planet.distance;
        mesh.rotation.x = planet.tilt * Math.PI / 180;
        scene.add(mesh);
        
        if (planet.distance > 0) {
          const orbitGeometry = new THREE.RingGeometry(planet.distance - 0.05, planet.distance + 0.05, 128);
          
          const colorMap = {
            "عطارد": 0xaaaaaa,
            "الزهرة": 0xffcc99,
            "الأرض": 0x3399ff,
            "المريخ": 0xff3333,
            "المشتري": 0xffaa33,
            "زحل": 0xffdd77,
            "أورانوس": 0x66ccff,
            "نبتون": 0x3366cc
          };
          
          const orbitMaterial = new THREE.MeshBasicMaterial({
            color: colorMap[planet.name] || 0xffffff,
            side: THREE.DoubleSide,
            transparent: true,
            opacity: 0.7
          });
          
          const orbit = new THREE.Mesh(orbitGeometry, orbitMaterial);
          orbit.rotation.x = Math.PI / 2;
          scene.add(orbit);
        }

        planetMeshes.push({
          mesh,
          planet,
          angle: 0
        });
      });
      
      // Saturn's Rings
      const ringTexture = new THREE.TextureLoader().load("textures/saturn_ring.png");
      const ringGeometry = new THREE.RingGeometry(2.5, 4, 64);
      const ringMaterial = new THREE.MeshStandardMaterial({
        map: ringTexture,
        transparent: true,
        side: THREE.DoubleSide
      });
      const rings = new THREE.Mesh(ringGeometry, ringMaterial);
      rings.rotation.x = Math.PI / 2;
      planetMeshes[6].mesh.add(rings);
      
      // Jupiter's Great Red Spot
      const spotGeometry = new THREE.SphereGeometry(0.3, 16, 16);
      const spotMaterial = new THREE.MeshStandardMaterial({
        color: 0xcc3300
      });
      const redSpot = new THREE.Mesh(spotGeometry, spotMaterial);
      redSpot.position.set(2.5, 0, 0);
      planetMeshes[5].mesh.add(redSpot);
      
      // Asteroid Belt
      const asteroidGeometry = new THREE.BufferGeometry();
      const asteroidCount = 1000;
      const asteroidPos = new Float32Array(asteroidCount * 3);
      for (let i = 0; i < asteroidCount; i++) {
        const angle = Math.random() * Math.PI * 2;
        const radius = 27 + Math.random() * 5;
        asteroidPos[i * 3] = Math.cos(angle) * radius;
        asteroidPos[i * 3 + 1] = (Math.random() - 0.5) * 0.5;
        asteroidPos[i * 3 + 2] = Math.sin(angle) * radius;
      }
      asteroidGeometry.setAttribute('position', new THREE.BufferAttribute(asteroidPos, 3));
      const asteroidMaterial = new THREE.PointsMaterial({
        color: 0x888888,
        size: 0.1
      });
      const asteroids = new THREE.Points(asteroidGeometry, asteroidMaterial);
      scene.add(asteroids);
      
      // Comet with Tail
      const cometGeometry = new THREE.SphereGeometry(0.2, 16, 16);
      const cometMaterial = new THREE.MeshStandardMaterial({
        color: 0x88ccff
      });
      const comet = new THREE.Mesh(cometGeometry, cometMaterial);
      scene.add(comet);
      const tailGeometry = new THREE.IcosahedronGeometry(0.5, 2);
      const vertices = tailGeometry.attributes.position.array;
      for (let i = 0; i < vertices.length; i += 3) {
        vertices[i] += Math.random() * 0.2 - 0.1;
        vertices[i + 1] += Math.random() * 0.2 - 0.1;
        vertices[i + 2] += Math.random() * 0.2 - 0.1;
      }
      tailGeometry.attributes.position.needsUpdate = true;
      const tailMaterial = new THREE.MeshStandardMaterial({
        color: 0x88ccff,
        transparent: true,
        opacity: 0.5
      });
      const tail = new THREE.Mesh(tailGeometry, tailMaterial);
      tail.rotation.x = Math.PI;
      tail.position.z = -1.5;
      comet.add(tail);
      
      // Dust Particles
      const dustGeometry = new THREE.BufferGeometry();
      const dustCount = 2000;
      const dustPos = new Float32Array(dustCount * 3);
      for (let i = 0; i < dustCount; i++) {
        dustPos[i * 3] = (Math.random() - 0.5) * 150;
        dustPos[i * 3 + 1] = (Math.random() - 0.5) * 150;
        dustPos[i * 3 + 2] = (Math.random() - 0.5) * 150;
      }
      dustGeometry.setAttribute('position', new THREE.BufferAttribute(dustPos, 3));
      const dustMaterial = new THREE.PointsMaterial({
        color: 0x666666,
        size: 0.05,
        transparent: true,
        opacity: 0.3
      });
      const dust = new THREE.Points(dustGeometry, dustMaterial);
      scene.add(dust);
      
      // Raycasting for Click Detection
      const raycaster = new THREE.Raycaster();
      const mouse = new THREE.Vector2();
      const infoPanel = document.getElementById('infoPanel');
      const planetName = document.getElementById('planetName');
      const planetInfo = document.getElementById('planetInfo');
      const closeBtn = document.getElementById('closeBtn');
      
      window.addEventListener('click', (event) => {
        // Check if click was on menu bar
        if (event.clientY < 50) return;
        
        mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
        mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
        raycaster.setFromCamera(mouse, camera);
        const intersects = raycaster.intersectObjects(planetMeshes.map(p => p.mesh));
        if (intersects.length > 0) {
          const planet = intersects[0].object;
          const data = planetMeshes.find(p => p.mesh === planet).planet;
          planetName.textContent = data.name;
          planetInfo.innerHTML = data.info.replace(/\n/g, '<br>');
          infoPanel.style.display = 'block';
        }
      });
      
      closeBtn.addEventListener('click', () => {
        infoPanel.style.display = 'none';
      });
      
      // Menu Bar Functionality
      const planetsMenu = document.getElementById('planetsMenu');
      const planetsDropdown = document.getElementById('planetsDropdown');
      
      planetsMenu.addEventListener('click', (e) => {
        e.stopPropagation();
        planetsDropdown.classList.toggle('show');
      });
      
      document.addEventListener('click', () => {
        planetsDropdown.classList.remove('show');
      });
      
      document.querySelectorAll('.dropdown-item').forEach(item => {
        item.addEventListener('click', (e) => {
          e.preventDefault();
          const planetIndex = parseInt(item.getAttribute('data-planet'));
          focusOnPlanet(planetIndex);
          planetsDropdown.classList.remove('show');
          infoPanel.style.display = 'none';
        });
      });
      
      function focusOnPlanet(index) {
        const planet = planetMeshes[index];
        const targetPosition = planet.mesh.position.clone();
        
        focusedPlanetIndex = index;
        
        if (index === 0) {
          targetPosition.z += 15;
        } else {
          const distance = planet.planet.radius * 10;
          targetPosition.z += distance;
        }
        
        const startPosition = camera.position.clone();
        const startTime = Date.now();
        const duration = 1500;
        
        function animateCamera() {
          const elapsed = Date.now() - startTime;
          const progress = Math.min(elapsed / duration, 1);
          
          const easeProgress = progress < 0.5 
            ? 2 * progress * progress 
            : 1 - Math.pow(-2 * progress + 2, 2) / 2;
          
          camera.position.lerpVectors(startPosition, targetPosition, easeProgress);
          camera.lookAt(planet.mesh.position);
          
          if (progress < 1) {
            requestAnimationFrame(animateCamera);
          } else {
            isFollowingPlanet = true;
            planetName.textContent = planet.planet.name;
            planetInfo.innerHTML = planet.planet.info.replace(/\n/g, '<br>');
            infoPanel.style.display = 'block';
          }
        }
        
        animateCamera();
      }
      
      // Animation Loop with Circular Orbits
      function animate() {
        requestAnimationFrame(animate);
        
        planetMeshes.forEach((planet, index) => {
          const { mesh, planet: data } = planet;
          if (data.distance > 0) {
            planet.angle += data.speed;
            mesh.position.x = Math.cos(planet.angle) * data.distance;
            mesh.position.z = Math.sin(planet.angle) * data.distance;
          }
          mesh.rotation.y += data.rotation;
          
          if (isFollowingPlanet && index === focusedPlanetIndex) {
            const targetPosition = mesh.position.clone();
            if (index === 0) {
              targetPosition.z += 15;
            } else {
              const distance = data.radius * 10;
              targetPosition.z += distance;
            }
            camera.position.copy(targetPosition);
            camera.lookAt(mesh.position);
          }
        });
        
        const cometAngle = Date.now() * 0.0005;
        comet.position.x = Math.cos(cometAngle) * 80;
        comet.position.z = Math.sin(cometAngle) * 80;
        comet.position.y = Math.sin(cometAngle * 2) * 20;
        
        if (!isFollowingPlanet) {
          controls.update();
        }
        renderer.render(scene, camera);
      }
      
      animate();
      
      window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });
    </script>
  </body>
</html>
